(this.webpackJsonptime_to_psc_csc=this.webpackJsonptime_to_psc_csc||[]).push([[0],{160:function(e,t,s){},164:function(e,t,s){"use strict";s.r(t);var n=s(1),i=s(28),r=s.n(i),a=(s(85),s(12)),c=s(13),o=s(7),l=s(30),h=s(29),d=s(80),m=s(75),p=s(79),u=s(15),j=s.n(u),b=s(0),C="You should go to {0} (Primary Stroke Center)",x="You should go to {0} (Comprehensive Stroke Center)",v=function(e){Object(l.a)(s,e);var t=Object(h.a)(s);function s(e){var n;Object(a.a)(this,s),(n=t.call(this,e)).handleChange=function(e){n.setState({[e.target.name]:e.target.value}),n.triggerHospitalChange([e.target.name],[e.target.value])},n.triggerHospitalChange=function(e,t){j.a.forEach(e,(function(e,s){n.state[e]=t[s]})),n.isCsc()?(n.setState({isCsc:!0}),n.setState({decisionText:x})):(n.setState({isCsc:!1}),n.setState({decisionText:C}))},n.isCsc=function(e){var t=e||n.state,s=t.ttCsc,i=t.ttPsc,r=t.ttBetween,a=t.cscNeedle,c=t.pscNeedle,o=parseInt(s,10),l=parseInt(i,10),h=parseInt(r,10);return!(o+parseInt(a,10)>l+parseInt(c,10)+h)};var i=0,r=15,c=45;e.timeBetween?i=e.timeBetween:e.type===D&&(i=30),e.pscList&&e.pscList[0]&&e.pscList[0].timeTo&&(r=e.pscList[0].timeTo),e.cscList&&e.cscList[0]&&e.cscList[0].timeTo&&(c=e.cscList[0].timeTo);var l={cscNeedle:30,pscNeedle:30,ttPsc:r,ttCsc:c,ttBetween:i,cpc:!1,isCsc:!1,decisionText:"You should go to {0} (Primary Stroke Center)"};return n.isCsc(l)&&(l.decisionText=x,l.isCsc=!0),n.state=l,n.state.decisionText=l.decisionText,n.state.isCsc=l.isCsc,n.renderClosestHospital=n.renderClosestHospital.bind(Object(o.a)(n)),n.renderDecisionText=n.renderDecisionText.bind(Object(o.a)(n)),n.isCsc=n.isCsc.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.renderSecondaryHospital=n.renderSecondaryHospital.bind(Object(o.a)(n)),n}return Object(c.a)(s,[{key:"renderClosestHospital",value:function(e,t){if(t)return Object(b.jsxs)("label",{children:["Closest ",e,":",Object(b.jsx)("br",{})," ",t.name," - ",t.city]})}},{key:"renderDecisionText",value:function(e,t){return e.replace(/\{0\}/,"".concat(t.name," - ").concat(t.city))}},{key:"renderSecondaryHospital",value:function(e,t,s){var n=parseInt(e.timeTo,10)+parseInt(t,10);return"".concat(e.name," - ").concat(e.city," (").concat(s,": ").concat(n," minutes)")}},{key:"render",value:function(){var e=this.props,t=e.title,s=e.rangeMessages,n=e.type,i=e.pscList,r=e.cscList,a=e.secondaryTimeToMessage,c=this.state,o=c.cscNeedle,l=c.pscNeedle,h=c.ttPsc,d=c.ttCsc,m=c.ttBetween,p=c.isCsc,u=c.decisionText;return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"row mt-3 mb-3",children:Object(b.jsxs)("h2",{className:"col-12 text-center",children:["Time to ",t]})}),Object(b.jsxs)("form",{children:[Object(b.jsxs)("div",{className:"row align-items-center",children:[Object(b.jsx)("label",{className:"col-"+(n===L?"6":"4"),htmlFor:"time-to-psc",children:"Time to Primary Stroke Center"}),Object(b.jsx)("label",{className:"col-"+(n===L?"6":"4"),htmlFor:"time-to-csc",children:"Time to Comprehensive Stroke Center"}),Object(b.jsx)("label",{className:"col-"+(n===L?" d-none":"4"),htmlFor:"time-between",children:"Time from Primary Stroke Center to Comprehensive Stroke Center"})]}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-"+(n===L?"6":"4"),children:Object(b.jsxs)("div",{className:"form-group",children:[this.renderClosestHospital("PSC",i[0]),Object(b.jsx)("input",{className:"form-control",type:"number",name:"ttPsc",id:"time-to-psc",value:h,onChange:this.handleChange})]})}),Object(b.jsx)("div",{className:"col-"+(n===L?"6":"4"),children:Object(b.jsxs)("div",{className:"form-group",children:[this.renderClosestHospital("CSC",r[0]),Object(b.jsx)("input",{className:"form-control",type:"number",name:"ttCsc",id:"time-to-csc",value:d,onChange:this.handleChange})]})}),Object(b.jsx)("div",{className:"col-"+(n===L?" d-none":"4"),children:Object(b.jsx)("div",{className:"form-group",children:Object(b.jsx)("input",{className:"form-control",type:"number",name:"ttBetween",id:"time-between",value:m,onChange:this.handleChange})})})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsxs)("label",{htmlFor:"pscNeedle",children:[s[0]," ",l]}),Object(b.jsx)("input",{type:"range",min:1,max:120,className:"form-control-range",id:"pscNeedle",name:"pscNeedle",value:l,onChange:this.handleChange}),Object(b.jsxs)("label",{htmlFor:"cscNeedle",children:[s[1]," ",o]}),Object(b.jsx)("input",{type:"range",min:1,max:120,className:"form-control-range",id:"cscNeedle",name:"cscNeedle",value:o,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"row align-items-center",children:[Object(b.jsx)("div",{className:"col-6 text-right",children:Object(b.jsxs)("span",{children:["Total time to ",t," if"]})}),Object(b.jsxs)("div",{className:"col-6",children:[Object(b.jsxs)("p",{children:["PSC First: ",Object(b.jsx)("strong",{children:parseInt(this.state.pscNeedle,10)+parseInt(this.state.ttPsc,10)})]}),Object(b.jsxs)("p",{children:["CSC First: ",Object(b.jsx)("strong",{children:parseInt(this.state.cscNeedle,10)+parseInt(this.state.ttCsc,10)})]}),n===D?Object(b.jsxs)("p",{children:["PSC requiring transfer to CSC: ",Object(b.jsx)("strong",{children:parseInt(this.state.pscNeedle,10)+parseInt(this.state.ttPsc,10)+parseInt(this.state.ttBetween,10)})]}):""]})]}),Object(b.jsx)("div",{className:"form-group",children:Object(b.jsx)("h2",{className:"col-12 text-center alert alert-"+(p?"danger":"dark"),children:this.renderDecisionText(u,p?r[0]:i[0])})})]}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-6",children:[Object(b.jsx)("h3",{children:"Secondary PSCs"}),Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{children:this.renderSecondaryHospital(i[1],this.state.pscNeedle,a)}),Object(b.jsx)("li",{children:this.renderSecondaryHospital(i[2],this.state.pscNeedle,a)}),Object(b.jsx)("li",{children:this.renderSecondaryHospital(i[3],this.state.pscNeedle,a)})]})]}),Object(b.jsxs)("div",{className:"col-6",children:[Object(b.jsx)("h3",{children:"Secondary CSCs"}),Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{children:this.renderSecondaryHospital(r[1],this.state.cscNeedle,a)}),Object(b.jsx)("li",{children:this.renderSecondaryHospital(r[2],this.state.cscNeedle,a)}),Object(b.jsx)("li",{children:this.renderSecondaryHospital(r[3],this.state.cscNeedle,a)})]})]})]})]})}}]),s}(n.Component),g=s(22),O=s.n(g),y=s(43),S=s(76),k=s.n(S),f=s(77),N=s.n(f),T=s(166),w=s(2),I=s(78),H=new T.a("AIzaSyCqxld5y5OsQBBi-euCeNG_6vyi_YFfc6o",{}),P=function(){function e(){Object(a.a)(this,e),this.comprehensiveStrokeCenters=Object(w.m)([]),this.primaryStrokeCenters=Object(w.m)([]),this.position={latitude:0,longitude:0},this.downloadNewList=this.downloadNewList.bind(this),this.getLocation=this.getLocation.bind(this),this.hasCsc=this.hasCsc.bind(this),this.hasPsc=this.hasPsc.bind(this)}return Object(c.a)(e,[{key:"getLocation",value:function(){var e=Object(y.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation.getCurrentPosition((function(t){e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setUserPosition",value:function(e){this.position={lat:e.coords.latitude,lng:e.coords.longitude}}},{key:"hasCsc",value:function(){return this.comprehensiveStrokeCenters||this.comprehensiveStrokeCenters.replace(sessionStorage.getItem("csc")),!!this.comprehensiveStrokeCenters}},{key:"hasPsc",value:function(){return this.primaryStrokeCenters||this.primaryStrokeCenters.replace(sessionStorage.getItem("psc")),!!this.primaryStrokeCenters}},{key:"downloadNewList",value:function(){var e=Object(y.a)(O.a.mark((function e(){var t,s,n,i,r,a,c,o,l,h,d,m,p,u,b,C=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0!==this.position.longitude||0!==this.position.latitude)&&this.position){e.next=6;break}return e.t0=this,e.next=4,this.getLocation();case 4:e.t1=e.sent,e.t0.setUserPosition.call(e.t0,e.t1);case 6:return e.next=8,k()({url:"https://api.codetabs.com/v1/proxy?quest=https://www.health.state.mn.us/diseases/cardiovascular/stroke/designationlist.html"});case 8:return t=e.sent,s=N.a.load(t.data),n=s('h2:contains("Comprehensive Stroke Center")').next("ol").children("li"),j.a.forEach(n,(function(e){C.comprehensiveStrokeCenters.push(Object(w.m)(C.parseHospital(e)))})),i=s('h2:contains("Primary Stroke Centers")').next("ol").children("li"),j.a.forEach(i,(function(e){C.primaryStrokeCenters.push(Object(w.m)(C.parseHospital(e)))})),e.next=16,H.load();case 16:return r=e.sent,a=new r.maps.DistanceMatrixService,c=Object(I.promisify)(a.getDistanceMatrix),o=this.position,e.prev=20,e.next=23,c({origins:[o],destinations:this.comprehensiveStrokeCenters.map((function(e){return"".concat(e.name," ").concat(e.city)})),travelMode:"DRIVING"});case 23:l=e.sent,h=this.parseDistanceMatrixResults(this.comprehensiveStrokeCenters,l),this.comprehensiveStrokeCenters.replace(h),e.next=32;break;case 28:e.prev=28,e.t2=e.catch(20),d=this.parseDistanceMatrixResults(this.comprehensiveStrokeCenters,e.t2),this.comprehensiveStrokeCenters.replace(d);case 32:return e.prev=32,e.next=35,c({origins:[o],destinations:this.primaryStrokeCenters.map((function(e){return"".concat(e.name," ").concat(e.city)})),travelMode:"DRIVING"});case 35:m=e.sent,p=this.parseDistanceMatrixResults(this.primaryStrokeCenters,m),this.primaryStrokeCenters.replace(p),e.next=44;break;case 40:e.prev=40,e.t3=e.catch(32),u=this.parseDistanceMatrixResults(this.primaryStrokeCenters,e.t3),this.primaryStrokeCenters.replace(u);case 44:return e.prev=44,e.next=47,c({origins:["".concat(this.primaryStrokeCenters[0].name," ").concat(this.primaryStrokeCenters[0].city)],destinations:["".concat(this.comprehensiveStrokeCenters[0].name," ").concat(this.comprehensiveStrokeCenters[0].city)],travelMode:"DRIVING"});case 47:b=e.sent,this.timeBetween=this.parseDistanceMatrixResults([{}],b)[0].timeTo,e.next=54;break;case 51:e.prev=51,e.t4=e.catch(44),this.timeBetween=this.parseDistanceMatrixResults([{}],e.t4)[0].timeTo;case 54:return sessionStorage.setItem("csc",this.comprehensiveStrokeCenters),sessionStorage.setItem("psc",this.primaryStrokeCenters),e.abrupt("return");case 57:case"end":return e.stop()}}),e,this,[[20,28],[32,40],[44,51]])})));return function(){return e.apply(this,arguments)}}()},{key:"parseDistanceMatrixResults",value:function(e,t){return j.a.forEach(t.rows[0].elements,(function(t,s){"OK"===t.status?(e[s].timeTo=Math.round(t.duration.value/60),e[s].timeToText=t.duration.text,e[s].timeToDistance=t.distance.text):(e[s].timeTo=99999999,e[s].timeToText="Failed Request",e[s].timeToDistance="Failed Request")})),j.a.orderBy(e,"timeTo","asc")}},{key:"parseHospital",value:function(e){var t=e.children[0].data.replace(/[\xe2\x80\u2013]/g,"-").replace(/[^\x00-\x7F]/g,"").split("-");if(3===t.length){var s=t[1].replace(/.*, /,"");t[0]=t[0]+s,t.splice(1,1)}return{name:t[0].trim(),city:t[1].trim()}}}]),e}(),D=(s(160),"Thrombectomy"),L="IV Alteplase",M=Object(d.a)(function(e){Object(l.a)(s,e);var t=Object(h.a)(s);function s(e,n){var i;return Object(a.a)(this,s),(i=t.call(this,e,n)).handleTabClick=function(e){e.preventDefault(),i.setState({tab:e.target.name})},i.handleTabClick=i.handleTabClick.bind(Object(o.a)(i)),i.state={tab:L,cscs:[],pscs:[],timeBetween:-1,loading:!0},i.locationHandler=new P,!i.locationHandler.hasCsc()&&i.locationHandler.hasPsc()||i.locationHandler.downloadNewList().then((function(){i.setState({tab:L,loading:!1})})),i}return Object(c.a)(s,[{key:"render",value:function(){var e=this.state,t=e.tab;return e.loading?Object(b.jsx)("div",{className:"row",style:{height:"50em"},children:Object(b.jsx)("div",{className:"mx-auto",style:{paddingTop:"40%"},children:Object(b.jsx)(m.a,{icon:p.a,spin:!0,size:"10x"})})}):Object(b.jsxs)("div",{className:"mt-1",children:[Object(b.jsxs)("nav",{className:"nav nav-tabs",children:[Object(b.jsx)("a",{className:"nav-item nav-link "+(t===L?"active":""),name:L,href:"#/",onClick:this.handleTabClick,children:"IV Alteplase"}),Object(b.jsx)("a",{className:"nav-item nav-link "+(t===D?"active":""),name:D,href:"#/",onClick:this.handleTabClick,children:"Thrombectomy"})]}),t===L?Object(b.jsx)(v,{type:L,title:"IV Alteplase",rangeMessages:["PSC Door-to-Needle Time:","CSC Door-to-Needle Time:"],secondaryTimeToMessage:"time to tPA",cscList:this.locationHandler.comprehensiveStrokeCenters,pscList:this.locationHandler.primaryStrokeCenters}):null,t===D?Object(b.jsx)(v,{type:D,title:"Arterial Puncture",rangeMessages:["PSC Door-in-Door-out Time:","CSC Door-to-Arterial Puncture Time:"],secondaryTimeToMessage:"time to puncture",timeBetween:this.locationHandler.timeBetween,cscList:this.locationHandler.comprehensiveStrokeCenters,pscList:this.locationHandler.primaryStrokeCenters}):null]})}}]),s}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s(161).config(),r.a.render(Object(b.jsx)(M,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},85:function(e,t,s){}},[[164,1,2]]]);
//# sourceMappingURL=main.2424f21b.chunk.js.map